% H"'+HH"+0.5H'^2-2G^2=0
% G"-HG'+H'G=0
% H(0)=H'(0)=H'(inf)=0
% G(0)=1;G(inf)=0
clear all
clc
N=100;
[D,x]=chep(N);
L=20;
scale =2/L;
D1=scale*D;
D2=(scale^2*D^2);
D3=(scale^3*D^3);
y=L*(x+1)/2;
%---------------------------------------------------------------------%
h00=y.*exp(-y)+exp(-y)-1;
h01=D1*h00;
h02=D1*h01;
h03=D1*h02;
%---------------------------------------------------------------------%
g00=exp(-y);
g01=D1*g00;
g02=D1*g01;
%--------------------------------------------------------------------%
H00=h00;H01=h01;H02=h02;H03=h03;
G00=g00;G01=g01;G02=g02;
ite=20;
%--------------------------------------------------------------------%
disp('________________________________________________________________')
disp('     i    F00(N+1)   F01(N+1)   TH00(N+1)    TH01(N+1)')
disp('________________________________________________________________')

for i=1:ite
A11=D3-diag(H00)*D2+diag(H01)*D1-diag(H02);
A12=-4*diag(G00);
A21=diag(G00)*D1-diag(G01);
A22=D2-diag(H00)*D1+diag(H01);
%-------------------------------------------------------------------%
R1=-(H03-H00.*H02+0.5*H01.*H01-2*G00.*G00);
R2=-(G02-H00.*G01+H01.*G00);
%-------------------------------------------------------------------%
A11(1,:)=D1(1,:);A12(1,:)=0;1;R1(1)=0;
A11(N+1,:)=0;A12(N+1,:)=0;A11(N+1,N+1)=1;R1(N+1)=0;
A11(N,:)=D1(N+1,:);A12(N,:)=0;R1(N)=0;
%-------------------------------------------------------------------%
A21(1,:)=0;A22(1,:)=0;A22(1,1)=1;R2(1)=0;
A21(N+1,:)=0;A22(N+1,:)=0;A22(N+1,N+1)=1;R2(N+1)=0;
%-------------------------------------------------------------------%
A=[A11 A12;A21 A22];
R=[R1;R2];
sol=A\R;
HS=sol(1:N+1);
GS=sol(N+2:2*N+2);
%-------------------------------------------------------------------%
H00=H00+HS;
H01=D1*H00;
H02=D1*H01;
H03=D1*H02;
%-------------------------------------------------------------------%
G00=G00+GS;
G01=D1*G00;
G02=D1*G01;
%-------------------------------------------------------------------%
fprintf('%5.0f\t %0.5f\t %0.5f\t %0.5f\t %0.5f\n',i,H00(N+1),H01(N+1),G00(N+1),G01(N+1))

end
figure(1)
plot(y,H00)
figure(2)
plot(y,G00)
